# AIReplacementInstructionCPU
AI-JSON replacement of processor instructions
### Advanced Instruction Analyzer & Optimizer

**Описание программы**  
Эта программа анализирует исполняемые файлы (EXE), находит  инструкции процессора (AVX2,FMA,F16C,BMI,BMI2) и заменяет их на AVX с использованием нейросетевых моделей. Ключевые особенности:
- Динамическая замена инструкций с валидацией через эмуляцию
- Бенчмаркинг производительности до/после замены
- Генерация оптимизированных бинарных файлов
- Обучение нейросети на пользовательских шаблонах замен

---

### Требования для запуска
**Python 3.9+** и следующие библиотеки:
```
pefile==2023.2.7
capstone==5.0.0
lief==0.13.2
tensorflow==2.15.0
numpy==1.26.3
unicorn==2.0.1
keystone-engine==0.9.2
scikit-learn==1.3.2
```

---

### Структура проекта
#### Основные папки:
1. **MNEMONICS**  
   Содержит шаблоны инструкций для разных архитектур:
   - `SSE.txt`, `AVX.txt`, `AVX2.txt` и др.  
   *Формат: по одной мнемонике на строке (например "addps")*

2. **NEO_RABBIT**  
   База знаний для замены инструкций (JSON-файлы):
   - `AVX2_AVX.json` - замены AVX2 → AVX
   - `F16C_AVX.json` - оптимизации для float16
   - `BMI2_AVX.json` - битовые операции  
   *Структура: {"original": "инструкция", "replacement": ["замена1", "замена2"]}*

3. **AI_MODEL**  
   Хранит нейросетевые компоненты:
   - `transformer_model.keras` - модель трансформера
   - `tokenizer.json` - словарь токенизатора
   - `model_config.json` - параметры модели
   - `feedback_data.json` - пользовательские правки

4. **CONFIG**  
   Конфигурационные файлы:
   - `model_config.ini` - настройки обучения нейросети

---

### Сильные стороны
1. **Гибкая замена инструкций**  
   - Комбинирование шаблонов (JSON) и нейросетевых предсказаний
   - Контекстно-зависимая замена (анализ соседних инструкций)

2. **Валидация изменений**  
   - Эмуляция через Unicorn Engine
   - Проверка идентичности результатов до/после замены

3. **Самообучающаяся система**  
   - Сохранение удачных замен в `feedback_data.json`
   - Автоматическое переобучение модели при изменении шаблонов

4. **Безопасный экспорт**  
   - Корректная модификация PE-файлов через LIEF
   - Создание новой секции для длинных инструкций

---

### Слабые стороны
1. **Требовательность к ресурсам**  
   - Обучение модели требует значительных вычислительных мощностей
   - Эмуляция больших бинарников может быть медленной

2. **Ограничения эмуляции**  
   - Не поддерживает сложные системные вызовы
   - Проблемы с инструкциями, меняющими состояние системы

3. **Зависимость от шаблонов**  
   - Качество замен зависит от полноты JSON-шаблонов
   - Требует ручной настройки для новых архитектур

---

### Как использовать
1. Загрузите EXE-файл через `Open File`
2. Выберите целевой набор инструкций (например AVX2)
3. Запустите анализ (`Analyze File`)
4. Примените AI-замену (`AI Replace`)
5. Проверьте результаты во вкладке `AI Replacement`
6. Экспортируйте оптимизированный файл (`Export Binary`)

---

### Особенности работы
- **Кэширование предсказаний** - ускорение повторных операций
- **Многоуровневая валидация**:
  1. Статический анализ через Capstone
  2. Динамическая эмуляция через Unicorn
  3. Бенчмаркинг производительности
- **Адаптивное обучение** - программа предлагает переобучить модель при изменении JSON-шаблонов

> **Важно:** Все замены сохраняются в `feedback_data.json` - вы можете дополнять базу знаний вручную, после чего программа автоматически дообучит нейросеть.

Для разработчиков: все параметры нейросети настраиваются через `CONFIG/model_config.ini` (размеры слоёв, скорость обучения и др.).

ВНИМАНИЯ!!! - модель нужно постоянно обновлять что бы не было ошибок в программе
